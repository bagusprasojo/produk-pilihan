<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Etalase Produk</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:wght@500;700&family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: light;
        --bg: #f7f4ef;
        --bg-accent: #f1e9dd;
        --card: #ffffff;
        --ink: #1e1b16;
        --muted: #6b6259;
        --accent: #d25b3c;
        --accent-2: #1f7a6f;
        --ring: rgba(30, 27, 22, 0.12);
        --shadow: 0 18px 60px rgba(30, 27, 22, 0.12);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Space Grotesk", "Segoe UI", sans-serif;
        color: var(--ink);
        background: radial-gradient(
            circle at 10% 0%,
            rgba(210, 91, 60, 0.18),
            transparent 45%
          ),
          radial-gradient(
            circle at 90% 10%,
            rgba(31, 122, 111, 0.2),
            transparent 40%
          ),
          linear-gradient(180deg, var(--bg) 0%, var(--bg-accent) 100%);
        min-height: 100vh;
      }

      .page {
        max-width: 1160px;
        margin: 0 auto;
        padding: 36px 20px 80px;
      }

      header {
        display: grid;
        gap: 16px;
        margin-bottom: 28px;
      }

      .eyebrow {
        text-transform: uppercase;
        letter-spacing: 0.18em;
        font-size: 12px;
        color: var(--muted);
      }

      h1 {
        margin: 0;
        font-family: "Fraunces", serif;
        font-size: clamp(2.2rem, 3vw, 3.5rem);
        line-height: 1.1;
      }

      .subhead {
        max-width: 720px;
        font-size: 1rem;
        color: var(--muted);
      }

      .stats {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
      }

      .stat-pill {
        padding: 8px 14px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid var(--ring);
        font-size: 0.9rem;
      }

      .controls {
        display: grid;
        gap: 12px;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        padding: 16px;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid var(--ring);
        border-radius: 18px;
        box-shadow: var(--shadow);
        margin-bottom: 22px;
      }

      .input,
      .select {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 14px;
        border-radius: 12px;
        background: #fff;
        border: 1px solid var(--ring);
        font-size: 0.95rem;
      }

      .input input,
      .select select {
        border: none;
        outline: none;
        flex: 1;
        font: inherit;
        background: transparent;
        color: var(--ink);
      }

      .grid {
        display: grid;
        gap: 18px;
        grid-template-columns: repeat(auto-fill, minmax(240px, 260px));
        justify-content: center;
      }

      .card {
        display: grid;
        grid-template-rows: 300px auto;
        background: var(--card);
        border-radius: 18px;
        overflow: hidden;
        box-shadow: var(--shadow);
        border: 1px solid rgba(255, 255, 255, 0.6);
        transform: translateY(0);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        animation: rise 0.5s ease both;
      }

      .card:hover {
        transform: translateY(-4px);
        box-shadow: 0 24px 80px rgba(30, 27, 22, 0.18);
      }

      .card-media {
        position: relative;
        background: linear-gradient(135deg, #f8f4ee 0%, #ece4d7 100%);
        overflow: hidden;
        padding: 12px;
      }

      .card-media img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        filter: saturate(1.05);
        border-radius: 12px;
      }

      .badge-row {
        position: absolute;
        left: 14px;
        bottom: 14px;
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .badge {
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 0.72rem;
        background: rgba(30, 27, 22, 0.8);
        color: #fff;
      }

      .card-body {
        padding: 16px 16px 18px;
        display: grid;
        gap: 10px;
      }

      .title {
        font-weight: 600;
        font-size: 1rem;
        margin: 0;
      }

      .meta {
        display: flex;
        justify-content: space-between;
        font-size: 0.85rem;
        color: var(--muted);
      }

      .desc {
        color: var(--muted);
        font-size: 0.9rem;
        line-height: 1.5;
        margin: 0;
      }

      .actions {
        display: flex;
        gap: 10px;
        margin-top: 4px;
      }

      .btn {
        flex: 1;
        padding: 10px 12px;
        border-radius: 12px;
        border: 1px solid transparent;
        font-weight: 600;
        text-align: center;
        text-decoration: none;
        font-size: 0.9rem;
      }

      .btn-primary {
        background: var(--accent);
        color: #fff;
      }

      .btn-ghost {
        border-color: var(--ring);
        color: var(--ink);
        background: #fff;
      }

      .pagination {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin-top: 26px;
        flex-wrap: wrap;
      }

      .page-btn {
        min-width: 36px;
        padding: 8px 12px;
        border-radius: 10px;
        border: 1px solid var(--ring);
        background: #fff;
        cursor: pointer;
        font-weight: 600;
      }

      .page-btn.active {
        background: var(--ink);
        color: #fff;
      }

      .empty {
        text-align: center;
        color: var(--muted);
        padding: 32px 0;
      }

      @keyframes rise {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @media (max-width: 640px) {
        .controls {
          grid-template-columns: 1fr;
        }
        .card {
          grid-template-rows: 280px auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="page">
      <header>
        <div class="eyebrow">Etalase</div>
        <h1>Produk pilihan hari ini.</h1>
        <p class="subhead">
          Jelajahi koleksi produk terbaru dengan tampilan modern dan responsif.
          Gunakan pencarian untuk mempercepat, lalu lanjutkan dengan pagination.
        </p>
        <div class="stats" id="stats"></div>
      </header>

      <section class="controls">
        <label class="input">
          <span>Search</span>
          <input
            id="searchInput"
            type="search"
            placeholder="Cari nama produk atau deskripsi"
          />
        </label>
        <label class="select">
          <span>Urutkan</span>
          <select id="sortSelect">
            <option value="newest">Terbaru</option>
            <option value="oldest">Terlama</option>
            <option value="title">Judul A-Z</option>
          </select>
        </label>
      </section>

      <section class="grid" id="grid"></section>
      <div class="pagination" id="pagination"></div>
      <div class="empty" id="emptyState" hidden>Tidak ada produk.</div>
    </div>

    <script>
      const state = {
        products: [],
        filtered: [],
        page: 1,
        pageSize: 6,
        query: "",
        sort: "newest",
      };

      const grid = document.getElementById("grid");
      const pagination = document.getElementById("pagination");
      const emptyState = document.getElementById("emptyState");
      const searchInput = document.getElementById("searchInput");
      const sortSelect = document.getElementById("sortSelect");
      const stats = document.getElementById("stats");

      const slugify = (value) =>
        value
          .toLowerCase()
          .replace(/[^a-z0-9\s-]/g, "")
          .replace(/\s+/g, "-")
          .replace(/-+/g, "-")
          .replace(/^-|-$/g, "");

      const formatDate = (value) => {
        if (!value) return "-";
        const date = new Date(value);
        if (Number.isNaN(date.getTime())) return value;
        return date.toLocaleDateString("id-ID", {
          day: "2-digit",
          month: "short",
          year: "numeric",
        });
      };

      const applyFilters = () => {
        const query = state.query.trim().toLowerCase();
        let items = [...state.products];
        if (query) {
          items = items.filter(
            (item) =>
              item.title.toLowerCase().includes(query) ||
              item.description.toLowerCase().includes(query)
          );
        }
        if (state.sort === "title") {
          items.sort((a, b) => a.title.localeCompare(b.title));
        } else if (state.sort === "oldest") {
          items.sort(
            (a, b) => new Date(a.tanggal || 0) - new Date(b.tanggal || 0)
          );
        } else {
          items.sort(
            (a, b) => new Date(b.tanggal || 0) - new Date(a.tanggal || 0)
          );
        }
        state.filtered = items;
        state.page = 1;
        render();
      };

      const renderStats = () => {
        const total = state.products.length;
        const latest = state.products[0]?.tanggal;
        stats.innerHTML = `
          <div class="stat-pill">${total} Produk</div>
          <div class="stat-pill">Update: ${formatDate(latest)}</div>
          <div class="stat-pill">Mode: Dinamis</div>
        `;
      };

      const renderGrid = () => {
        const start = (state.page - 1) * state.pageSize;
        const end = start + state.pageSize;
        const slice = state.filtered.slice(start, end);

        grid.innerHTML = "";
        if (!slice.length) {
          emptyState.hidden = false;
          return;
        }
        emptyState.hidden = true;

        const fragment = document.createDocumentFragment();
        slice.forEach((product, index) => {
          const card = document.createElement("article");
          card.className = "card";
          card.style.animationDelay = `${index * 0.06}s`;
          const slug = slugify(product.title);
          const badges = [product.status1, product.status2, product.review]
            .filter(Boolean)
            .map((text) => `<span class="badge">${text}</span>`)
            .join("");
          card.innerHTML = `
            <div class="card-media">
              <img src="${product.image}" alt="${product.title}" loading="lazy" />
              <div class="badge-row">${badges}</div>
            </div>
            <div class="card-body">
              <h2 class="title">${product.title}</h2>
              <div class="meta">
                <span>${formatDate(product.tanggal)}</span>
                <span>${product.review || " "}</span>
              </div>
              <p class="desc">${product.description}</p>
              <div class="actions">
                <a class="btn btn-ghost" href="p/${slug}.html">Detail</a>
                <a
                  class="btn btn-primary"
                  href="${product.affiliate_url}"
                  target="_blank"
                  rel="noreferrer"
                  >Beli</a
                >
              </div>
            </div>
          `;
          fragment.appendChild(card);
        });
        grid.appendChild(fragment);
      };

      const renderPagination = () => {
        const totalPages = Math.ceil(state.filtered.length / state.pageSize);
        pagination.innerHTML = "";
        if (totalPages <= 1) return;

        const createButton = (label, page, isActive = false) => {
          const button = document.createElement("button");
          button.className = `page-btn${isActive ? " active" : ""}`;
          button.textContent = label;
          button.addEventListener("click", () => {
            state.page = page;
            render();
            window.scrollTo({ top: 0, behavior: "smooth" });
          });
          return button;
        };

        pagination.appendChild(
          createButton("Prev", Math.max(1, state.page - 1))
        );

        const maxButtons = 5;
        let start = Math.max(1, state.page - 2);
        let end = Math.min(totalPages, start + maxButtons - 1);
        if (end - start < maxButtons - 1) {
          start = Math.max(1, end - maxButtons + 1);
        }

        for (let i = start; i <= end; i += 1) {
          pagination.appendChild(createButton(i, i, i === state.page));
        }

        pagination.appendChild(
          createButton("Next", Math.min(totalPages, state.page + 1))
        );
      };

      const render = () => {
        renderGrid();
        renderPagination();
      };

      searchInput.addEventListener("input", (event) => {
        state.query = event.target.value;
        applyFilters();
      });

      sortSelect.addEventListener("change", (event) => {
        state.sort = event.target.value;
        applyFilters();
      });

      fetch("products.json")
        .then((response) => response.json())
        .then((data) => {
          state.products = data;
          renderStats();
          applyFilters();
        })
        .catch(() => {
          emptyState.hidden = false;
          emptyState.textContent = "Gagal memuat data produk.";
        });
    </script>
  </body>
</html>
